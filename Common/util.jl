module Util

export flatten, maxby, minby

using Plots, ColorSchemes

colorcube =
   [0.3333     0.3333     0.0000
    0.3333     0.6667     0.0000
    0.3333     1.0000     0.0000
    0.6667     0.3333     0.0000
    0.6667     0.6667     0.0000
    0.6667     1.0000     0.0000
    1.0000     0.3333     0.0000
    1.0000     0.6667     0.0000
    1.0000     1.0000     0.0000
    0.0000     0.3333     0.5000
    0.0000     0.6667     0.5000
    0.0000     1.0000     0.5000
    0.3333     0.0000     0.5000
    0.3333     0.3333     0.5000
    0.3333     0.6667     0.5000
    0.3333     1.0000     0.5000
    0.6667     0.0000     0.5000
    0.6667     0.3333     0.5000
    0.6667     0.6667     0.5000
    0.6667     1.0000     0.5000
    1.0000     0.0000     0.5000
    1.0000     0.3333     0.5000
    1.0000     0.6667     0.5000
    1.0000     1.0000     0.5000
    0.0000     0.3333     1.0000
    0.0000     0.6667     1.0000
    0.0000     1.0000     1.0000
    0.3333     0.0000     1.0000
    0.3333     0.3333     1.0000
    0.3333     0.6667     1.0000
    0.3333     1.0000     1.0000
    0.6667     0.0000     1.0000
    0.6667     0.3333     1.0000
    0.6667     0.6667     1.0000
    0.6667     1.0000     1.0000
    1.0000     0.0000     1.0000
    1.0000     0.3333     1.0000
    1.0000     0.6667     1.0000
    0.1667     0.0000     0.0000
    0.3333     0.0000     0.0000
    0.5000     0.0000     0.0000
    0.6667     0.0000     0.0000
    0.8333     0.0000     0.0000
    1.0000     0.0000     0.0000
    0.0000     0.1667     0.0000
    0.0000     0.3333     0.0000
    0.0000     0.5000     0.0000
    0.0000     0.6667     0.0000
    0.0000     0.8333     0.0000
    0.0000     1.0000     0.0000
    0.0000     0.0000     0.1667
    0.0000     0.0000     0.3333
    0.0000     0.0000     0.5000
    0.0000     0.0000     0.6667
    0.0000     0.0000     0.8333
    0.0000     0.0000     1.0000
    0.0000     0.0000     0.0000
    0.1429     0.1429     0.1429
    0.2857     0.2857     0.2857
    0.4286     0.4286     0.4286
    0.5714     0.5714     0.5714
    0.7143     0.7143     0.7143
    0.8571     0.8571     0.8571
    1.0000     1.0000     1.0000];

"""
Registers additional colormaps.
"""
function register_gradients()
     getclr = v -> RGB(v[1], v[2], v[3])
     cb = map(i -> getclr(colorcube[i, :]), 1:size(colorcube, 1))
     PlotUtils.register_gradient_colors(:colorcube, cb)

     blk =  getclr([0 0 0]); cb[end, :] = blk
     PlotUtils.register_gradient_colors(:colorcube1, cb)

     cb = append!([blk], cb);
     PlotUtils.register_gradient_colors(:colorcube2, cb[1:64])

     for cs in schemes
          PlotUtils.register_gradient_colors(cs, eval(ColorSchemes, cs))
     end
end

function flatten(x...)
     collect(Iterators.flatten(x))
end

function maxby(f, x...)
     maximum(f.(flatten(x...)))
end

function minby(f, x...)
     minimum(f.(flatten(x...)))
end

end